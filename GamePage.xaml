<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="MauiProject.GamePage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    Title="Игра">

    <Grid RowDefinitions="Auto,Auto,*,*"
        Padding="12"
        RowSpacing="10">

        <!-- Верхняя панель -->
        <Grid Grid.Row="0"
          ColumnDefinitions="*,Auto,Auto,Auto"
          ColumnSpacing="8"
          VerticalOptions="Center">
            <Label x:Name="LblStatus" FontSize="16" />
            <Button x:Name="BtnUndo" Grid.Column="1" Text="↶ Назад" Clicked="BtnUndo_Clicked"
              BackgroundColor="#1E1F25" TextColor="White" CornerRadius="14" HeightRequest="40" />
            <Button x:Name="BtnEnd"  Grid.Column="2" Text="Завершить" Clicked="BtnEnd_Clicked"
              BackgroundColor="#6750A4" TextColor="White" CornerRadius="14" HeightRequest="40" />
            <Label x:Name="LblTime"  Grid.Column="3" FontSize="18"
             HorizontalTextAlignment="End" VerticalTextAlignment="Center"/>
        </Grid>

        <!-- Превью -->
        <Frame Grid.Row="1" Padding="8" BackgroundColor="#1E1F25" BorderColor="#2B2D36"
           CornerRadius="16" HasShadow="False">
            <Image x:Name="ImgPreview" HeightRequest="100" Aspect="AspectFill" HorizontalOptions="Center" />
        </Frame>

        <!-- Источник: FlexLayout + оверлей вопроса -->
        <Frame Grid.Row="2" Padding="0" BackgroundColor="#1E1F25" BorderColor="#2B2D36"
           CornerRadius="16" HasShadow="False">
            <Grid x:Name="SourceHost">
                <ScrollView>
                    <FlexLayout x:Name="SourcePanel"
                      Padding="8"
                      Wrap="Wrap"
                      Direction="Row"
                      JustifyContent="Start"
                      AlignItems="Start"
                      AlignContent="Start"
                      BackgroundColor="#FFF8E1"/>
                </ScrollView>

                <!-- ВОПРОС поверх SourcePanel -->
                <Grid x:Name="QuestionOverlay" IsVisible="false" BackgroundColor="#66000000">
                    <Frame Padding="14" BackgroundColor="White" BorderColor="#BDBDBD"
                 CornerRadius="16" HasShadow="False"
                 HorizontalOptions="Center" VerticalOptions="Center">
                        <VerticalStackLayout Spacing="10">
                            <Label x:Name="LblQuestion" TextColor="Black" FontSize="16"
                     HorizontalTextAlignment="Center" />
                            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                                <Button x:Name="BtnA" Grid.Column="0" Clicked="BtnA_Clicked"
                        BackgroundColor="#EFEFEF" TextColor="Black" CornerRadius="12" />
                                <Button x:Name="BtnB" Grid.Column="1" Clicked="BtnB_Clicked"
                        BackgroundColor="#EFEFEF" TextColor="Black" CornerRadius="12" />
                            </Grid>
                            <Button x:Name="BtnNext" Text="Далее →" IsVisible="false"
                      BackgroundColor="#6750A4" TextColor="White" CornerRadius="14"
                      HorizontalOptions="End" Clicked="BtnNext_Clicked"/>
                        </VerticalStackLayout>
                    </Frame>
                </Grid>
            </Grid>
        </Frame>

        <!-- Цель: контейнер; 7×7 клеток создадим один раз в коде -->
        <Frame Grid.Row="3" Padding="0" BackgroundColor="#1E1F25" BorderColor="#2B2D36"
           CornerRadius="16" HasShadow="False">
            <Grid x:Name="TargetHost" />
        </Frame>

    </Grid>
</ContentPage>
